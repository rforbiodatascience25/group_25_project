---
title: "Group 25 Project"
author:
  - "André Godinho s253707"
  - "Szymon Cholewiński s253711"
  - "Magnus Strange s190867 "
  - "Lily Whipple s243865"
  - "Catarina Anastácio s253709"
format:
  revealjs:
    theme: serif # choose different themes
    logo: DTU_logo.png #choose a logo to put in here
    footer: "R for Bio Data Science 2025 - Group 25 Project"
    code-block-height: 500px # maximum height of a code block, if it surpases this height becames scrollbar
    css: 
      - presentation_css.css
bibliography: references.bib
reference-location: section
---

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false
# package import
library("tidyverse")
library("here")
library("broom")
library("patchwork")
```

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false
# data input
data_metrics <- read_tsv(here("data","data_metrics_aug.tsv"))
data_gene <- read_tsv(here("data","data_gene_aug.tsv"))
data_score <- read_tsv(here("data","data_score_aug.tsv"))
data_code <- read_tsv(here("data","data_code_aug.tsv"))
data_diag <- read_tsv(here("data","data_diag_aug.tsv"))
```

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false
theme_uniform <- function(base_size = 14, base_family = "sans") {
  theme_minimal(base_size = base_size, base_family = base_family) +
    theme(
      plot.title    = element_text(face = "bold", size = base_size + 2, hjust = 0),
      axis.title    = element_text(face = "bold"),
      axis.text     = element_text(color = "gray20"),
      panel.grid.minor = element_blank(),
      panel.grid.major = element_line(color = "gray90", size = 0.3),
      strip.text    = element_text(face = "bold"),
      strip.background = element_rect(fill = "gray95", color = NA),
      legend.position = "right",
      legend.title = element_text(face = "bold"),
      plot.margin = margin(10, 10, 10, 10)
    )
}

#colorblind-safe color PALETTE
#pick values for color and fill
palette <- c(
  "#E69F00", "#56B4E9", "#009E73",
  "#F0E442", "#0072B2", "#D55E00", "#CC79A7"
)

#colorblind-safe color GRADIENTS
scale_fill_uniform_continuous  <- scale_fill_gradientn(
  colors = c("#2166AC", "#F7F7F7", "#B2182B")
)
scale_color_uniform_continuous <- scale_color_gradientn(
  colors = c("#2166AC", "#F7F7F7", "#B2182B")
)

#geometry defaults
update_geom_defaults("line",   list(linewidth = 1))
update_geom_defaults("point",  list(size = 2, stroke = 0.5))
update_geom_defaults("boxplot", list(linewidth = 0.6))
update_geom_defaults("violin",  list(linewidth = 0.6))

#presentation settings
presentation_fig_width  <- 7
presentation_fig_height <- 4.5
presentation_dpi        <- 200

#aspect ratios
aspect_wide    <- c(width = 7,  height = 4)   #wide (16:9) for time series / line plots:
aspect_square  <- c(width = 5,  height = 5)   #square (1:1) for correlations & scatter:
aspect_tall    <- c(width = 5,  height = 7)   #tall (3:4) for barplots with long labels:

#annotation settings high contrast
annotation_text <- list(color = "black", size = 5, fontface = "bold")

#remove excess padding
scale_y_continuous_uniform <- scale_y_continuous(expand = expansion(mult = c(0, 0.05)))
scale_x_continuous_uniform <- scale_x_continuous(expand = expansion(mult = c(0.02, 0.02)))
```

## Introduction

-   Analysis of Pancreatic Adenocarcinoma The Cancer Genome Atlas (TCGA) PanCancer data [@BioPortal; @TCGA_data]

-   Pancreatic cancers estimated deaths rank 3rd across cancers in USA in 2025 [@CancStat] -\> relevant data

-   Data contained cancer genomic data, scores and classification -\> enough information to perform analysis

-   After initial analysis it didn't look tidy -\> ideal for the project purposes

::::::: columns
:::: {.column width="50%"}
::: {style="text-align: center;"}
![](ExampleTissue.png){width="500"}
:::
::::

:::: {.column width="50%"}
::: {style="text-align: center;"}
![](ExampleTissue2.png){width="500"}
:::
::::
:::::::

::: {style="font-size: 40%;"}
Parts of image TCGA-2L-AAQI-01Z taken from [@BioPortal; @TCGA_data; @Slide]
:::

## Methods and Materials

```{r}
#| echo: true
#| eval: true
#| output: true
```

::::: rows
::: {.row height="50%"}
Materials:

-   Pancreatic Adenocarcinoma The Cancer Genome Atlas (TCGA) PanCancer dataset [@BioPortal; @TCGA_data]

-   R studio (R, tidyverse)

-   draw.io (just presentation)
:::

::: {.row height="50%" style="text-align: center;"}
Methodology

![](Projectflow.drawio.png){width="925"}
:::
:::::

## Data Description 1: Overview of Data Partitions

184 patient samples; 63 clinical variables.

![](04description1.png){width="90%"}

------------------------------------------------------------------------

## Data Description 2: Example Patient Metadata Overview

```{r}
#| echo: false      
#| eval: true         
#| message: false
#| output: true
#| fig-width: 13
#| fig-height: 8
#| fig-align: "center"
#| out-width: 100%

# define metric columns
metric_cols <- c(
  "Diagnosis Age",
  "Sex",
  "Genetic Ancestry Label",
  "Race Category",
  "Ethnicity Category"
)

# recode Race Category
data_metrics <- data_metrics %>%
  mutate(`Race Category` = recode(`Race Category`,
                                  "Black or African American" = "Black"))

#<<<<<<< HEAD
# ----- create bubble plot and save PNG
# png("bubble_plot.png", width = 1080, height = 756, res = 96)      ->>>>>>>>>>>>>< use ggsave

#=======
# ----- create bubble plot
#>>>>>>> 4a99f71725e4554a84ca1dd1b59a2b691aef7939
bubble_plot <- data_metrics %>%
  count(Sex, `Genetic Ancestry Label`, `Race Category`, `Ethnicity Category`) %>%
  ggplot(aes(x = `Genetic Ancestry Label`,
             y = `Race Category`,
             size = n)) +
  geom_point(aes(fill = interaction(`Genetic Ancestry Label`,
                                    `Race Category`,
                                    `Ethnicity Category`)),
             color = "black", shape = 21,
             stroke = 0.5, alpha = 0.7) +
  geom_text(aes(label = n), color = "black", vjust = -1, size = 6) +
  facet_wrap(Sex ~ `Ethnicity Category`) +
  scale_size(range = c(4, 40)) +
  labs(
    title = "82% of cancer patients are White European (Non-Hispanic/Latino or Other)",
    size = "Count", x = NULL, y = NULL
  ) +
  theme_minimal(base_size = 16) +
  scale_fill_manual(values = c(
    "#000000", "#E69F00", "#56B4E9", "#009E73",
    "#F0E442", "#0072B2", "#D55E00", "#CC79A7"
  )) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none",
    plot.margin = margin(t = 10, r = 5, b = 10, l = 5)
  )
bubble_plot
```

------------------------------------------------------------------------

## PCA on numeric data

PCA reduced the data to a few components while retaining most of the variance.

PCA loadings were plotted and revealed groups of strongly correlated variables, indicating redundancy in the feature set.

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false

data_all <- data_metrics |>
  left_join(data_gene,  by = "Patient ID") |>
  left_join(data_score, by = "Patient ID") |>
  left_join(data_code,  by = "Patient ID") |>
  left_join(data_diag,  by = "Patient ID")

pca_data <- data_all |>
  select(
    where(is.numeric),
    -c(`Overall Survival (Months)`,
       `Disease Free (Months)`,
       `Months of disease-specific survival`,
       `Progress Free Survival (Months)`,
       `Disease Free Status (bin)`,
       `Disease Free (days)`, # loads of NA because some die
       `Days of disease-specific survival`,
       `Progress Free Survival (days)`
    ) 
  )  |> 
  drop_na()

pca_fit <- pca_data |> 
  select(-`Disease-specific Survival status (bin)`) |> 
  scale() |> 
  prcomp()
```

::::: columns
::: {.column width="50%"}
-   Some separation is observed!

```{r}
#| echo: false
#| eval: true
#| output: true
#| message: false
#| fig-width: 9
#| fig-height: 6
#| fig-align: "center"
#| out-width: 100%
pca_fit |>
  augment(pca_data) |>
  ggplot(aes(x = .fittedPC1,
             y = .fittedPC2,
             color = factor(`Disease-specific Survival status (bin)`))) +
  geom_point(size = 1.5) +
  scale_color_discrete(
    name   = "Disease-specific Survival status",
    labels = c("ALIVE OR DEAD TUMOR FREE", "DEAD WITH TUMOR")  # 0 -> "Alive", 1 -> "Dead"
  ) +
  labs(
    title = "PCA of diagnostic variables",
    x = "Principal Component 1",
    y = "Principal Component 2"
  ) +
  theme_uniform() +
  theme(
    legend.position = "bottom",
    legend.direction = "horizontal"
  )
```
:::

::: {.column width="50%"}
```{r}
#| echo: false
#| eval: true
#| output: true
#| message: false
#| fig-width: 7
#| fig-height: 6
#| fig-align: "center"
#| out-width: 90%

pca_fit |> 
  tidy(matrix = "eigenvalues") |> 
  ggplot(aes(PC, cumulative)) +
  geom_col(fill = "#56B4E9", alpha = 0.8) +
  geom_hline(yintercept = 0.8,
             linetype = "dashed",
             color = "grey30",
             linewidth = 0.6) +
  scale_x_continuous(breaks = 1:14) +
  scale_y_continuous(
  breaks = c(0, 0.25, 0.5, 0.75, 0.8, 1),
  labels = scales::percent_format(),
  expand = expansion(mult = c(0, 0.01))
) +
  theme_uniform() +
  labs(
  x = "Principal component",
  y = "Cumulative variance across PCs",
  title = "Cumulative explained variance by principal component"
)

```
:::
:::::

## [Genomic Alterations Across AJCC Cancer Stages]{.smalltitle}

Genomic instability is present at all AJCC stages, not just in advanced disease.

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false

# 0) Join data
data_gene_code = full_join(data_gene, data_code, by = "Patient ID")

# 1) Find stages with > 10 samples
stages_keep <- data_gene_code |>
  rename(NDSA_stage = `Neoplasm Disease Stage American Joint Committee on Cancer Code`) |>
  count(NDSA_stage, name = "n_samples") |>
  filter(n_samples > 10)

# 2) Labels
stage_labels <- stages_keep |>
  mutate(stage_label = str_c(NDSA_stage, " (n=", n_samples, ")")) |>
  select(NDSA_stage, stage_label)

# 3) Keep full data only for those stages
data_gene_code_filtered <- data_gene_code |>
  rename(NDSA_stage = `Neoplasm Disease Stage American Joint Committee on Cancer Code`) |>
  filter(`Mutation Count` < 5000,
         `Tumor Break Load` < 200,
         !is.na(NDSA_stage)) |> 
  semi_join(stages_keep, by = "NDSA_stage") 

# 4) Working data with labels ready
data_gene_code_filtered <- data_gene_code_filtered |>
  left_join(stage_labels, by = "NDSA_stage")
```

::::: columns
::: {.column width="60%"}
```{r}
#| echo: true
#| eval: false
#| output: false
#| message: false
data_gene_code_filtered |>
  left_join(stage_labels, by = "NDSA_stage") |>
  pivot_longer(
    cols = c(
      `Fraction Genome Altered`,
      `Mutation Count`,
      `Tumor Break Load`
    ),
    names_to = "Genomic_Metric",
    values_to = "Value"
  ) |>
  ggplot(aes(x = stage_label, y = Value)) +
  geom_violin() +
  geom_boxplot(width = 0.2) +
  facet_wrap(~ Genomic_Metric, 
             scales = "free_y", 
             ncol = 1) +
  theme_uniform() +
  theme(axis.text.x = element_text(angle = 45, 
                                   hjust = 1)) +
  labs(
    x = "AJCC stage (n per stage)",
    y = "Genomic metric",
    title = "Genomic instability metrics across 
    AJCC stages")
```

-   Later stages tend to include more extreme values.
-   Overlap between neighboring stages, so stage alone doesn’t perfectly separate genomic burden.
:::

::: {.column width="40%"}
```{r}
#| echo: false
#| eval: true
#| output: true
#| message: false
#| fig-width: 6
#| fig-height: 8
#| fig-align: "center"
#| out-width: 80%

data_gene_code_filtered |>
  pivot_longer(
    cols = c(
      `Fraction Genome Altered`,
      `Mutation Count`,
      `Tumor Break Load`
    ),
    names_to = "Genomic_Metric",
    values_to = "Value"
  ) |>
  ggplot(aes(x = stage_label, y = Value)) +
  geom_violin() +
  geom_boxplot(width = 0.2) +
  facet_wrap(~ Genomic_Metric, 
             scales = "free_y", 
             ncol = 1) +
  theme_uniform() +
  theme(axis.text.x = element_text(angle = 45, 
                                   hjust = 1)) +
  labs(
    x = "AJCC stage (n per stage)",
    y = "Genomic metric",
    title = "Genomic instability metrics across AJCC stages")
```
:::
:::::

## Patient Survival based on Hypoxia and Tumor Break Load interaction {.smalltitle}

Tumor structural instability (Tumor Break Load) interacts with oxygen deprivation (hypoxia) to influence patient survival, highlighting biologically aggressive tumor subtypes.

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false

# Prepare data
data_gene_diag_score <- data_gene |>
  full_join(data_diag, by = "Patient ID") |>
  full_join(data_score, by = "Patient ID") |>
  drop_na() 
```

::::: columns
::: {.column width="35%"}
-   Patients with high hypoxia and high Tumor Break Load show the worst survival overall.
-   Mixed groups ('high/low') exhibit better survival than the 'low/low' group, suggesting that the presence of only one adverse factor may partially buffer the harmful impact.
:::

::: {.column width="65%"}
```{r}
#| echo: false
#| eval: true
#| output: true
#| message: false
#| fig-width: 8
#| fig-height: 6
#| fig-align: "center"
#| out-width: 90%

data_heatmap <- data_gene_diag_score |>
  pivot_longer(
      cols = c(`Winter Hypoxia Score`, 
               `Buffa Hypoxia Score`),
      names_to = "Hypoxia_Score_Type",
      values_to = "Hypoxia_Value"
    ) |>
  mutate(
    Mut_Count_Bin = case_when(
      `Tumor Break Load` > median(`Tumor Break Load`, na.rm = TRUE) ~ "High Tumor Break Load",
      `Tumor Break Load` <= median(`Tumor Break Load`, na.rm = TRUE) ~ "Low Tumor Break Load")) |>
  group_by(Hypoxia_Score_Type) |>
  mutate(
    Hypoxia_Bin = case_when(
      Hypoxia_Value > median(Hypoxia_Value, na.rm = TRUE) ~ "High Hypoxia",
      Hypoxia_Value <= median(Hypoxia_Value, na.rm = TRUE) ~ "Low Hypoxia"))|>
  ungroup()|>
  group_by(Hypoxia_Score_Type, Mut_Count_Bin, Hypoxia_Bin) |>
  summarise(Median_Survival = median(`Overall Survival (days)`), .groups = 'drop') 
  
# Plotting
ggplot(data_heatmap, aes(x = Mut_Count_Bin, 
                         y = Hypoxia_Bin, 
                         fill = Median_Survival)) +
  geom_tile(color = "white") +
  geom_text(aes(label = round(Median_Survival, 0)), 
            color = "white", 
            size = 6) +
  scale_fill_gradient(
    low = "red",
    high = "#2ECC71",
    name = "Median Survival (Days)"
  ) + 
  facet_wrap(~ Hypoxia_Score_Type, ncol=1) +
  theme_minimal() + 
  theme(
      plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
      plot.subtitle = element_text(hjust = 0.5),
      axis.text = element_text(color = "black"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
    ) +
    labs(
      title = "Median Overall Survival (Days)",
      subtitle = "Interaction between Tumor Break Load and Hypoxia Score",
      x = "Tumor Break Load", 
      y = "Hypoxia Score"
    )
```
:::
:::::

## Survival of Radiation Therapy Patients based on levels of Hypoxia {.smalltitle}

Low oxygen levels in tumors (Hypoxia) are usually associated with resistance to radiation therapy.

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false


# Hypoxia Data  
data_hypoxia <- data_diag |>
  full_join(data_score, by = "Patient ID") |>
  select(PatientID = `Patient ID`,
         `Buffa Hypoxia Score`,
         `Ragnum Hypoxia Score`,
         `Winter Hypoxia Score`,
         `Radiation Therapy`,
         `Overall Survival (days)`,
         `Disease-specific Survival status (bin)`) |>
  drop_na("Buffa Hypoxia Score", 
          "Ragnum Hypoxia Score",
          "Winter Hypoxia Score",
          "Radiation Therapy") |>
  rename(Status_Tumor = `Disease-specific Survival status (bin)`) 
  
```

::::: columns
::: {.column width="50%"}
Large variability across Hypoxia Scoring methods:

-   Buffa Score: Higher hypoxia → unexpectedly better survival

-   Ragnum Score: Lower hypoxia → clear survival advantage

-   Winter Score: Lower hypoxia → better survival, but less pronounced than Ragnum

Evident variations in Hypoxia Score algorithms limit our ability to fully assess the impact of tumor hypoxia on radiotherapy survival outcomes.
:::

::: {.column width="50%"}
```{r}
#| echo: false
#| eval: true
#| output: true
#| message: false
#| fig-width: 5
#| fig-height: 5
#| fig-align: "center"
#| out-width: 90%

# Calculation of Kaplan-Meier with hypoxia data
Kaplan_meier_data <- data_hypoxia |>
  pivot_longer(
    cols = c(
      `Buffa Hypoxia Score`,
      `Ragnum Hypoxia Score`,
      `Winter Hypoxia Score`
    ),
    names_to = "Hypoxia_Type",
    values_to = "Hypoxia_Score"
  ) |>
  group_by(Hypoxia_Type) |>
  mutate(
    hyp_med = median(Hypoxia_Score, na.rm = TRUE), 
    Hypoxia_Group = case_when(
    Hypoxia_Score > hyp_med ~ "High Hypoxia Score",
    Hypoxia_Score <= hyp_med ~ "Low Hypoxia Score"
    )) |>
  ungroup() |>
  filter(`Radiation Therapy` == "Yes") |>
  select(
    Hypoxia_Type,
    time = `Overall Survival (days)`,
    status = `Status_Tumor`,
    group = Hypoxia_Group
  ) |>
  arrange(Hypoxia_Type, group, time) |>
  group_by(Hypoxia_Type, group, time, status) |>
  tally() |>
  pivot_wider(
    names_from = status,
    values_from = n,
    values_fill = 0
  ) |>
  rename(events = `1`, censored = `0`) |>
  group_by(Hypoxia_Type, group) |>
  mutate(
    n_risk = rev(cumsum(rev(events + censored))),
    surv_step = 1 - events / n_risk,
    surv = cumprod(surv_step)
  ) |>
  ungroup()

# Plot KM curve
ggplot(Kaplan_meier_data, aes(x = time, 
                              y = surv, 
                              color = group)) +
  geom_step(linewidth = 1.1) +
  scale_color_manual(
    values = c("High Hypoxia Score" = "red",
               "Low Hypoxia Score"  = "blue")) +
  scale_y_continuous(limits = c(0, 1)) +
  facet_wrap(~ Hypoxia_Type, ncol=1) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    legend.position = "bottom"
  ) +
  labs(
    title = "Survival of Radiation Therapy Patients\nHigh vs Low Hypoxia (Buffa Score)",
    x = "Time (days)",
    y = "Survival Probability",
    color = "Hypoxia Group"
  )

```
:::
:::::

## Hypoxia and MSI scores

- Scoring methods poorly agree, labeling patients and tumors inconsistently.

- Buffa and Winter align, but others disagree on hypoxia, MSI.

- Buffa and Ragnum scores rose with grade, especially in tumors.


::::: columns
::: {.column width="50%"}
```{r}
#| echo: false
#| eval: true
#| output: true
#| message: false
#| fig-width: 8
#| fig-height: 9
#| fig-align: "center"
#| out-width: 100%

metric_for_order_msi     <- "MSIsensor Score"
metric_for_order_hypoxia <- "Winter Hypoxia Score"

# Long + scaled (as before)
df_long <- data_score |>
  select(`Patient ID`,
         `MSI MANTIS Score`,
         `MSIsensor Score`,
         `Buffa Hypoxia Score`,
         `Ragnum Hypoxia Score`,
         `Winter Hypoxia Score`) |>
  drop_na() |>
  pivot_longer(
    cols = -`Patient ID`,
    names_to = "Metric",
    values_to = "Score"
  ) |>
  group_by(Metric) |>
  mutate(
    Score_scaled = (Score - mean(Score, na.rm = TRUE)) /
                   sd(Score, na.rm = TRUE)
  ) |>
  ungroup()

# MSI: order by MSI metric
df_msi <- df_long |>
  filter(Metric %in% c("MSI MANTIS Score", "MSIsensor Score")) |>
  group_by(`Patient ID`) |>
  mutate(
    order_value = Score_scaled[Metric == metric_for_order_msi][1]
  ) |>
  ungroup() |>
  mutate(
    `Patient ID` = fct_reorder(`Patient ID`, order_value, .desc = TRUE)
  )

# Hypoxia: order by Winter hypoxia
df_hypoxia <- df_long |>
  filter(Metric %in% c("Buffa Hypoxia Score",
                       "Ragnum Hypoxia Score",
                       "Winter Hypoxia Score")) |>
  group_by(`Patient ID`) |>
  mutate(
    order_value = Score_scaled[Metric == metric_for_order_hypoxia][1]
  ) |>
  ungroup() |>
  mutate(
    `Patient ID` = fct_reorder(`Patient ID`, order_value, .desc = TRUE)
  )

MSI_heatmap <- ggplot(df_msi,
       aes(x = `Patient ID`, y = Metric, fill = Score_scaled)) +
  geom_tile() +
  scale_fill_viridis_c(name = "z-score") +   # name here
  theme_uniform() +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank()) +
  labs(
    title = "MSI scores across patients (z-scaled)",
    x = "Patient", y = "MSI metric"
  )

hypoxia_heatmap <- ggplot(df_hypoxia,
       aes(x = `Patient ID`, y = Metric, fill = Score_scaled)) +
  geom_tile() +
  scale_fill_viridis_c(name = "z-score") +   # same here
  theme_uniform() +
  theme(axis.text.x = element_blank(),
        axis.ticks.x = element_blank()) +
  labs(
    title = "Hypoxia scores across patients (z-scaled)",
    x = "Patient", y = "Hypoxia metric"
  )

hypoxia_heatmap / MSI_heatmap
```

:::

::: {.column width="50%"}
```{r}
#| echo: false
#| eval: true
#| output: true
#| message: false
#| fig-width: 10
#| fig-height: 9
#| fig-align: "center"
#| out-width: 100%
data_score |>
  left_join(data_diag |>
  select(`Patient ID`,
    `Neoplasm Histologic Grade`,
    `Person Neoplasm Cancer Status`),
    by = "Patient ID") |>
  filter(!is.na(`Neoplasm Histologic Grade`),
    !`Neoplasm Histologic Grade` %in% c("GX", "G4")) |>
  pivot_longer(cols = c(`Buffa Hypoxia Score`,
    `Ragnum Hypoxia Score`,
    `MSI MANTIS Score`,
    `MSIsensor Score`),
    names_to  = "Metric",
    values_to = "Score") |>
  filter(!is.na(Score),
    !is.na(`Neoplasm Histologic Grade`),
    !is.na(`Person Neoplasm Cancer Status`)) |>
  ggplot(aes(x = `Neoplasm Histologic Grade`,
    y = Score,
    fill = `Person Neoplasm Cancer Status`)) +
  geom_boxplot(alpha = 0.7,
    outlier.shape = NA) +
  facet_wrap(~ Metric,
    scales = "free_y") +
  scale_fill_manual(values = palette) +
  scale_y_continuous_uniform +
  scale_x_discrete(expand = expansion(mult = c(0.02, 0.02))) +
  labs(title = "Distribution of Scores Across Histologic Grades by Cancer Status",
    x = "Neoplasm Histologic Grade",
    y = "Score",
    fill  = "Cancer Status") +
  theme_uniform()
```
:::
:::::

## Conclusion

Results for patients outside the 50–80 age range should be interpreted cautiously due to low sample counts.

Predominantly White patient representation highlights the need for greater ethnic diversity.

Limited variability in several categories may constrain findings.

Future analyses could be strengthened by adding more clinical and molecular data and increasing sample diversity, including underrepresented groups.

## References
