---
title: "Group 25 Project"
author:
  - "André Godinho s253707"
  - "Szymon Cholewiński s253711"
  - "Magnus Strange s190867 "
  - "Lily Whipple s243865"
  - "Catarina Anastácio s253709"
format:
  revealjs: 
    theme: serif # choose different themes
    logo: DTU_logo.png #choose a logo to put in here
    footer: "R for Bio Data Science 2025 - Group 25 Project"
    code-block-height: 500px # maximum height of a code block, if it surpases this height becames scrollbar
    css: 
      - presentation_css.css
---

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false
# package import
library("tidyverse")
library("here")
```

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false
# data input
data_metrics <- read_tsv(here("data","data_metrics_aug.tsv"))
data_gene <- read_tsv(here("data","data_gene_aug.tsv"))
data_score <- read_tsv(here("data","data_score_aug.tsv"))
data_code <- read_tsv(here("data","data_code_aug.tsv"))
data_diag <- read_tsv(here("data","data_diag_aug.tsv"))
```

## Introduction (Szymon)

```         
-   Analysis of Pancreatic Adenocarcinoma The Cancer Genome Atlas (TCGA) PanCancer data \[ref: https://www.cbioportal.org/study/filesAndLinks?id=paad_tcga_pan_can_atlas_2018\]

-   Pancreatic cancers estimated deaths rank 3rd across cancers in USA in 2025 \[ref: https://acsjournals.onlinelibrary.wiley.com/doi/10.3322/caac.21871\] -> relevant data

-   Data contained cancer genomic data, scores and classification -> enough information to perform analysis

-   After initial analysis it didn't look tidy -> ideal for the project purposes
```

::::: columns
::: {.column width="50%"}
![](ExampleTissue.png){width="650"}
:::

::: {.column width="50%"}
![](ExampleTissue2.png)
:::
:::::

```         
Part of image (FFPE HE TP DX1) taken from [ref: https://viewer.imaging.datacommons.cancer.gov/viewer/2.25.50549866694142022371455976348397677571]
```

## Methods and Materials (Szymon)

```{r}
#| echo: true
#| eval: true
#| output: true
```

::::: rows
::: {.row height="50%"}
Materials:

-   Pancreatic Adenocarcinoma The Cancer Genome Atlas (TCGA) PanCancer dataset \[ref:\]

-   R studio (R, tidyverse)

-   draw.io (just presentation)
:::

::: {.row height="50%"}
Methodology

![](Project flow.drawio.png){width="925"}
:::
:::::

## Describing the data (1) (Magnus)

-   Explain the division of variables trough the different datasets
-   Includes clinical data for pancreatic adenocarcinoma (PAAD) patients from the TCGA Pan-Cancer Atlas.\
-   Made of 184 patient samples and 63 clinical variables (demographics, diagnosis, staging, molecular metrics, outcomes).

------------------------------------------------------------------------

## Descring the data (2) (Magnus)

```{r}
#| echo: true
#| eval: true
#| output: true

iris
```

## [Genomic Alterations Across AJCC Cancer Stages]{.smalltitle}

Genomic instability is present at all AJCC stages, not just in advanced disease.

```{r}
#| echo: false
#| eval: true
#| output: false
#| message: false

# 0) Join data
data_gene_code = full_join(data_gene, data_code, by = "Patient ID")

# 1) Find stages with > 10 samples
stages_keep <- data_gene_code |>
  rename(NDSA_stage = `Neoplasm Disease Stage American Joint Committee on Cancer Code`) |>
  count(NDSA_stage, name = "n_samples") |>
  filter(n_samples > 10)

# 2) Labels
stage_labels <- stages_keep |>
  mutate(stage_label = str_c(NDSA_stage, " (n=", n_samples, ")")) |>
  select(NDSA_stage, stage_label)

# 3) Keep full data only for those stages
data_gene_code_filtered <- data_gene_code |>
  rename(NDSA_stage = `Neoplasm Disease Stage American Joint Committee on Cancer Code`) |>
  filter(`Mutation Count` < 5000,
         `Tumor Break Load` < 200,
         !is.na(NDSA_stage)) |> 
  semi_join(stages_keep, by = "NDSA_stage") 

# 4) Working data with labels ready
data_gene_code_filtered <- data_gene_code_filtered |>
  left_join(stage_labels, by = "NDSA_stage")
```

::::: columns
::: {.column width="60%"}
```{r}
#| echo: true
#| eval: false
#| output: false
#| message: false
data_gene_code_filtered |>
  pivot_longer(
    cols = c(
      `Fraction Genome Altered`,
      `Mutation Count`,
      `Tumor Break Load`
    ),
    names_to = "Genomic_Metric",
    values_to = "Value"
  ) |>
  ggplot(aes(x = stage_label, y = Value)) +
  geom_boxplot() +
  facet_wrap(~ Genomic_Metric, 
             scales = "free_y", 
             nrow = 1) +
  theme(axis.text.x = element_text(angle = 45, 
                                   hjust = 1)) +
  labs(
    x = "AJCC stage (n per stage)",
    y = "Genomic metric")
```

-   Later stages tend to include more extreme values;
-   Overlap between neighboring stages, so stage alone doesn’t perfectly separate genomic burden
:::

::: {.column width="40%"}
```{r}
#| echo: false
#| eval: true
#| output: true
#| message: false
#| fig-width: 4
#| fig-height: 6
#| fig-align: "center"
#| out-width: 80%
data_gene_code_filtered |>
  pivot_longer(
    cols = c(
      `Fraction Genome Altered`,
      `Mutation Count`,
      `Tumor Break Load`
    ),
    names_to = "Genomic_Metric",
    values_to = "Value"
  ) |>
  ggplot(aes(x = stage_label, y = Value)) +
  geom_boxplot() +
  facet_wrap(~ Genomic_Metric, 
             scales = "free_y", 
             ncol = 1) +
  theme(axis.text.x = element_text(angle = 45, 
                                   hjust = 1)) +
  labs(
    x = "AJCC stage (n per stage)",
    y = "Genomic metric")
```
:::
:::::

## Results (2) (Andre) {background-color="aquamarine"}

```{r}
#| echo: true
#| eval: true
#| output: true
#| output-location: slide #slide, column, fragment, column-fragment

iris |> 
  ggplot(mapping = 
           aes(x=Sepal.Length, 
               y = Sepal.Width)) +
  geom_point()

```

## Results (3) (Catarina)

## Discussion (2) (Catarina)

## Discussion (3) (Lily)

## Conclusion (Lily)

quick remarks

weird data, not enough variance

other types code

ways to go forward

more data ::::::::::::
